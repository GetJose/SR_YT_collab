{% extends 'base.html' %}

{% block content %}
<div class="profile-container interest">
  <h2>Selecione suas áreas de interesse</h2>
  <form method="post" id="interest-form">
    <div class="interest_area">
    {% csrf_token %}
    {% for interest in form.interests.field.queryset %}
      {% if interest.is_root %}
        {% include 'interest_recursive.html' with interest=interest selected_interests=form.initial.interests %}
      {% endif %}
    {% endfor %}
  </div>
    <div class="button-group">
      <button type="submit" class="btn-save">Salvar</button>
      <button type="button" id="clear-selection" class="btn-clear">Limpar Seleções</button>
    </div>
  </form>
  
</div>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
    const categories = document.querySelectorAll('.interest-category > label > input');

    categories.forEach(input => {
        const subInterests = input.closest('.interest-category').querySelector('.sub-interests');
        
        if (subInterests) {
            // Exibir ou ocultar subinteresses com base no estado inicial
            subInterests.style.display = input.checked ? 'block' : 'none';

            input.addEventListener('change', function() {
                if (input.checked) {
                    // Exibir subinteresses ao marcar o pai
                    subInterests.style.display = 'block';
                } else {
                    // Verificar se há filhos selecionados
                    const anyChildChecked = Array.from(subInterests.querySelectorAll('input')).some(child => child.checked);

                    if (!anyChildChecked) {
                        // Ocultar os subinteresses somente se nenhum filho estiver marcado
                        subInterests.style.display = 'none';
                        subInterests.querySelectorAll('input').forEach(subInput => subInput.checked = false);
                    } else {
                        // Manter os filhos visíveis se algum estiver marcado
                        subInterests.style.display = 'block';
                    }
                }
            });
        }
    });
});
document.addEventListener('DOMContentLoaded', function () {
    const clearButton = document.getElementById('clear-selection');
    clearButton.addEventListener('click', function () {
        // Desmarcar todos os checkboxes
        document.querySelectorAll('#interest-form input[type="checkbox"]').forEach(input => {
            input.checked = false;
        });

        // Ocultar todas as subcategorias
        document.querySelectorAll('.sub-interests').forEach(subInterests => {
            subInterests.style.display = 'none';
        });
    });
});


  </script>
{% endblock %}
